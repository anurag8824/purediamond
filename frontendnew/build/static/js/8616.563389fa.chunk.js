"use strict";(self.webpackChunkfair_react=self.webpackChunkfair_react||[]).push([[8616],{68616:(a,e,n)=>{n.r(e),n.d(e,{default:()=>v});var s=n(84919),l=n(9950),r=n(60666),i=n(26473),c=n(9449),t=n(27232),d=n(88306),o=n(39564),u=n(39402),m=n(97758),h=(n(70103),n(44414));const v=()=>{var a,e,n,v,x,j;const p=(0,u.Y)(),{client:b,loading:N,error:f,refresh:g}=(0,m.h)(),w=l.useMemo((()=>{var a,e;return r.Ik().shape({narration:r.Yj().required("Remark is required").trim(),transactionPassword:r.Yj().required("Transaction Password is required"),amount:r.ai().required("Amount is required").transform((a=>isNaN(a)?0:+a)).min(1,"Amount is required").max((null===b||void 0===b||null===(a=b.balance)||void 0===a?void 0:a.balance)||0,"Max ".concat(((null===b||void 0===b||null===(e=b.balance)||void 0===e?void 0:e.balance)||0).toFixed(2)," limit"))})}),[b]),{register:A,handleSubmit:k,reset:y,watch:P,formState:{errors:q}}=(0,c.mN)({resolver:(0,i.t)(w),defaultValues:{amount:"",narration:"",transactionPassword:""}}),B=Number(P("amount")||0),C=null!==(a=null===b||void 0===b||null===(e=b.parentBalance)||void 0===e?void 0:e.balance)&&void 0!==a?a:0,S=null!==(n=null===b||void 0===b||null===(v=b.balance)||void 0===v?void 0:v.balance)&&void 0!==n?n:0,U=k((a=>{if(!b)return;const e=(0,s.A)((0,s.A)({},a),{},{userId:b._id,parentUserId:"admin"===b.role?b._id:b.parentId,balanceUpdateType:"W"});o.A.updateDepositBalance(e).then((()=>{t.oR.success("Balance withdrawn successfully"),y(),g()}))}));return N?(0,h.jsx)("div",{className:"client-action-page",children:(0,h.jsx)("div",{className:"loading-state",children:"Loading client details..."})}):f||!b?(0,h.jsx)("div",{className:"client-action-page",children:(0,h.jsxs)("div",{className:"empty-state",children:["Unable to load requested client.",(0,h.jsx)("span",{children:f||"Please go back and try again."})]})}):(0,h.jsx)("div",{className:"client-action-page",children:(0,h.jsxs)("div",{className:"client-action-card",children:[(0,h.jsx)("div",{className:"client-action-back",children:(0,h.jsxs)("button",{className:"btn btn-secondary",onClick:()=>p.back(),children:[(0,h.jsx)("i",{className:"fas fa-arrow-left"})," Back"]})}),(0,h.jsxs)("div",{className:"client-action-heading",children:[(0,h.jsx)("h2",{children:"Bank Withdraw"}),(0,h.jsxs)("p",{children:["Return chips from ",b.username," to ",(null===(x=b.parent)||void 0===x?void 0:x.username)||"parent"]})]}),(0,h.jsxs)("div",{className:"client-balance-board",children:[(0,h.jsxs)("div",{className:"client-balance-card",children:[(0,h.jsx)("h4",{children:"Parent Balance"}),(0,h.jsx)("div",{className:"client-name",children:(null===(j=b.parent)||void 0===j?void 0:j.username)||"Parent"}),(0,h.jsxs)("div",{className:"client-balance-values",children:[(0,h.jsx)("span",{children:C.toFixed(2)}),(0,h.jsx)("span",{className:"arrow",children:"\u2192"}),(0,h.jsx)("span",{children:(C+B).toFixed(2)})]})]}),(0,h.jsxs)("div",{className:"client-balance-card",children:[(0,h.jsx)("h4",{children:"Client Balance"}),(0,h.jsx)("div",{className:"client-name",children:b.username}),(0,h.jsxs)("div",{className:"client-balance-values",children:[(0,h.jsx)("span",{children:S.toFixed(2)}),(0,h.jsx)("span",{className:"arrow",children:"\u2192"}),(0,h.jsx)("span",{children:(S-B).toFixed(2)})]})]})]}),(0,h.jsxs)("form",{className:"client-action-form",onSubmit:U,children:[(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Amount"}),(0,h.jsx)("input",(0,s.A)((0,s.A)({type:"number",step:"0.01",min:0,className:"form-control"},A("amount")),{},{placeholder:"Enter withdraw amount"})),(null===q||void 0===q?void 0:q.amount)&&(0,h.jsx)("span",{className:"error",children:q.amount.message})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Remark"}),(0,h.jsx)("textarea",(0,s.A)((0,s.A)({className:"form-control",rows:3},A("narration")),{},{placeholder:"Describe the transaction reason"})),(null===q||void 0===q?void 0:q.narration)&&(0,h.jsx)("span",{className:"error",children:q.narration.message})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Transaction Password"}),(0,h.jsx)("input",(0,s.A)((0,s.A)({type:"password",className:"form-control"},A("transactionPassword")),{},{placeholder:"Enter transaction password"})),(null===q||void 0===q?void 0:q.transactionPassword)&&(0,h.jsx)("span",{className:"error",children:q.transactionPassword.message})]}),(0,h.jsxs)("div",{className:"client-action-footer",children:[(0,h.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>p.back(),children:"Cancel"}),(0,h.jsxs)(d.A,{type:"submit",className:"btn btn-primary",children:[(0,h.jsx)("i",{className:"fas fa-check mr-2"})," Submit"]})]})]})]})})}},97758:(a,e,n)=>{n.d(e,{h:()=>i});var s=n(9950),l=n(28429),r=n(39564);const i=()=>{const{username:a}=(0,l.g)(),[e,n]=s.useState(null),[i,c]=s.useState(!0),[t,d]=s.useState(null),o=s.useCallback((()=>{if(!a)return n(null),c(!1),void d("Username missing in URL");c(!0),d(null),r.A.getParentUserDetail(a).then((a=>{var e,s;const l=null===(e=a.data)||void 0===e||null===(s=e.data)||void 0===s?void 0:s[0];n(null!==l&&void 0!==l?l:null)})).catch((()=>{n(null),d("Unable to load client details. Please try again.")})).finally((()=>c(!1)))}),[a]);return s.useEffect((()=>{o()}),[o]),{username:a,client:e,loading:i,error:t,refresh:o}}},88306:(a,e,n)=>{n.d(e,{A:()=>d});var s=n(84919),l=n(79222),r=(n(9950),n(96487)),i=n(28674),c=n(44414);const t=["children"],d=a=>{const{children:e}=a,n=(0,l.A)(a,t),d=(0,i.G)(r.Mm);return(0,c.jsx)("button",(0,s.A)((0,s.A)({disabled:d},n),{},{children:e}))}},70103:()=>{}}]);