"use strict";(self.webpackChunkfair_react=self.webpackChunkfair_react||[]).push([[8466],{78466:(e,a,n)=>{n.r(a),n.d(a,{default:()=>v});var s=n(84919),r=n(9950),l=n(60666),i=n(26473),c=n(9449),t=n(27232),d=n(88306),o=n(39564),u=n(39402),m=n(97758),h=(n(70103),n(44414));const v=()=>{var e,a,n,v,x,p;const j=(0,u.Y)(),{client:b,loading:N,error:f,refresh:g}=(0,m.h)(),A=r.useMemo((()=>{var e,a;return l.Ik().shape({narration:l.Yj().required("Remark is required"),transactionPassword:l.Yj().required("Transaction Password is required"),amount:"admin"===(null===b||void 0===b?void 0:b.role)?l.ai().required("Amount is required").transform((e=>isNaN(e)?0:+e)).min(1,"Amount is required"):l.ai().required("Amount is required").transform((e=>isNaN(e)?0:+e)).min(1,"Amount is required").max((null===b||void 0===b||null===(e=b.parentBalance)||void 0===e?void 0:e.balance)||0,"Max ".concat(((null===b||void 0===b||null===(a=b.parentBalance)||void 0===a?void 0:a.balance)||0).toFixed(2)," limit"))})}),[b]),{register:k,handleSubmit:w,reset:y,watch:P,formState:{errors:q}}=(0,c.mN)({resolver:(0,i.t)(A),defaultValues:{amount:"",narration:"",transactionPassword:""}}),B=Number(P("amount")||0),C=null!==(e=null===b||void 0===b||null===(a=b.parentBalance)||void 0===a?void 0:a.balance)&&void 0!==e?e:0,S=null!==(n=null===b||void 0===b||null===(v=b.balance)||void 0===v?void 0:v.balance)&&void 0!==n?n:0,U=w((e=>{if(!b)return;const a=(0,s.A)((0,s.A)({},e),{},{userId:b._id,parentUserId:"admin"===b.role?b._id:b.parentId,balanceUpdateType:"D"});o.A.updateDepositBalance(a).then((()=>{t.oR.success("Deposit balance updated successfully"),y(),g()}))}));return N?(0,h.jsx)("div",{className:"client-action-page",children:(0,h.jsx)("div",{className:"loading-state",children:"Loading client details..."})}):f||!b?(0,h.jsx)("div",{className:"client-action-page",children:(0,h.jsxs)("div",{className:"empty-state",children:["Unable to load requested client.",(0,h.jsx)("span",{children:f||"Please go back and try again."})]})}):(0,h.jsx)("div",{className:"client-action-page",children:(0,h.jsxs)("div",{className:"client-action-card",children:[(0,h.jsx)("div",{className:"client-action-back",children:(0,h.jsxs)("button",{className:"btn btn-secondary",onClick:()=>j.back(),children:[(0,h.jsx)("i",{className:"fas fa-arrow-left"})," Back"]})}),(0,h.jsxs)("div",{className:"client-action-heading",children:[(0,h.jsx)("h2",{children:"Bank Deposit"}),(0,h.jsxs)("p",{children:["Transfer chips from ",(null===(x=b.parent)||void 0===x?void 0:x.username)||"parent"," to ",b.username]})]}),(0,h.jsxs)("div",{className:"client-balance-board",children:[(0,h.jsxs)("div",{className:"client-balance-card",children:[(0,h.jsx)("h4",{children:"Parent Balance"}),(0,h.jsx)("div",{className:"client-name",children:(null===(p=b.parent)||void 0===p?void 0:p.username)||"Parent"}),(0,h.jsxs)("div",{className:"client-balance-values",children:[(0,h.jsx)("span",{children:C.toFixed(2)}),(0,h.jsx)("span",{className:"arrow",children:"\u2192"}),(0,h.jsx)("span",{children:(C-B).toFixed(2)})]})]}),(0,h.jsxs)("div",{className:"client-balance-card",children:[(0,h.jsx)("h4",{children:"Client Balance"}),(0,h.jsx)("div",{className:"client-name",children:b.username}),(0,h.jsxs)("div",{className:"client-balance-values",children:[(0,h.jsx)("span",{children:S.toFixed(2)}),(0,h.jsx)("span",{className:"arrow",children:"\u2192"}),(0,h.jsx)("span",{children:(S+B).toFixed(2)})]})]})]}),(0,h.jsxs)("form",{className:"client-action-form",onSubmit:U,children:[(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Amount"}),(0,h.jsx)("input",(0,s.A)((0,s.A)({type:"number",step:"0.01",min:0,className:"form-control"},k("amount")),{},{placeholder:"Enter transfer amount"})),(null===q||void 0===q?void 0:q.amount)&&(0,h.jsx)("span",{className:"error",children:q.amount.message})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Remark"}),(0,h.jsx)("textarea",(0,s.A)((0,s.A)({className:"form-control",rows:3},k("narration")),{},{placeholder:"Describe the transaction reason"})),(null===q||void 0===q?void 0:q.narration)&&(0,h.jsx)("span",{className:"error",children:q.narration.message})]}),(0,h.jsxs)("div",{className:"form-group",children:[(0,h.jsx)("label",{children:"Transaction Password"}),(0,h.jsx)("input",(0,s.A)((0,s.A)({type:"password",className:"form-control"},k("transactionPassword")),{},{placeholder:"Enter transaction password"})),(null===q||void 0===q?void 0:q.transactionPassword)&&(0,h.jsx)("span",{className:"error",children:q.transactionPassword.message})]}),(0,h.jsxs)("div",{className:"client-action-footer",children:[(0,h.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>j.back(),children:"Cancel"}),(0,h.jsxs)(d.A,{type:"submit",className:"btn btn-primary",children:[(0,h.jsx)("i",{className:"fas fa-check mr-2"})," Submit"]})]})]})]})})}},97758:(e,a,n)=>{n.d(a,{h:()=>i});var s=n(9950),r=n(28429),l=n(39564);const i=()=>{const{username:e}=(0,r.g)(),[a,n]=s.useState(null),[i,c]=s.useState(!0),[t,d]=s.useState(null),o=s.useCallback((()=>{if(!e)return n(null),c(!1),void d("Username missing in URL");c(!0),d(null),l.A.getParentUserDetail(e).then((e=>{var a,s;const r=null===(a=e.data)||void 0===a||null===(s=a.data)||void 0===s?void 0:s[0];n(null!==r&&void 0!==r?r:null)})).catch((()=>{n(null),d("Unable to load client details. Please try again.")})).finally((()=>c(!1)))}),[e]);return s.useEffect((()=>{o()}),[o]),{username:e,client:a,loading:i,error:t,refresh:o}}},88306:(e,a,n)=>{n.d(a,{A:()=>d});var s=n(84919),r=n(79222),l=(n(9950),n(96487)),i=n(28674),c=n(44414);const t=["children"],d=e=>{const{children:a}=e,n=(0,r.A)(e,t),d=(0,i.G)(l.Mm);return(0,c.jsx)("button",(0,s.A)((0,s.A)({disabled:d},n),{},{children:a}))}},70103:()=>{}}]);